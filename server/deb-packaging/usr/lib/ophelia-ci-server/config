# DEBIAN/config

#!/bin/sh

set -e

. /usr/share/debconf/confmodule

if [ ! -f /etc/ophelia-ci/server-config.toml ]; then
    echo "/etc/ophelia-ci/server-config.toml not found!" >&2
    exit 1
fi

db_get ophelia-ci/server-port
server_port="$RET"

db_get ophelia-ci/db-path
db_path="$RET"

db_get ophelia-ci/expiration-time
expiration_time="$RET"

db_get ophelia-ci/secret
secret="$RET"

db_get ophelia-ci/ssl-cert-file
ssl_cert_file="$RET"

db_get ophelia-ci/ssl-key-file
ssl_key_file="$RET"

/usr/lib/ophelia-ci-server/configure_toml.py /etc/ophelia-ci/server-config.toml "$server_port" "$db_path" "$expiration_time" "$secret" "$ssl_cert_file" "$ssl_key_file"

exit 0